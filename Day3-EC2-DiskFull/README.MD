# ğŸš€ Scenario 3: EC2 Disk Full

## ğŸ“ Problem Statement
EC2 instance root volume filled due to uncontrolled log growth â†’ â€œNo space left on deviceâ€ errors.  
Impact: applications crash, updates fail, potential downtime.

---

## âš™ï¸ Environment Setup
- **Region:** ap-south-1 (Mumbai)  
- **Instance Type:** t2.micro  
- **Key Pair:** <key_pair.pem>  
- **Folder:** Day3-EC2-DiskFull  

---

## ğŸ”„ Steps to Reproduce

### 1ï¸âƒ£ Baseline Check

df -h

lsblk

Explanation: df -h â†’ human-readable disk usage; lsblk â†’ shows partitions 
Expected Output**: Current disk usage & partitions

Screenshots**: disk_baseline_dfh.png, disk_baseline_lsblk.png

---

### 2ï¸âƒ£ Simulate Disk Full

sudo dd if=/dev/zero of=/var/log/fillfile bs=1M count=5000
sudo dd if=/dev/zero of=/var/log/fillfile2 bs=1M count=3000

Explanation: Fills disk with dummy files to trigger â€œNo space leftâ€
Expected Error: dd: error writing '/var/log/fillfile2': No space left on device

Screenshot: disk_after_fill_dfh.png

---

### 3ï¸âƒ£ Troubleshoot Disk Space

**Step 3A â€” Identify Large Files** 

sudo du -sh /var/log/*
sudo du -sh /var/*

Screenshot: disk_top_consumers.png, disk_varlog_sizes.png

**Step 3B â€” Cleanup Logs**

sudo truncate -s 0 /var/log/messages
sudo truncate -s 0 /var/log/secure

Screenshot: disk_after_cleanup_dfh.png

---

### 4ï¸âƒ£ Expand EBS Volume (Optional)

Before: ebs_volume_before.png â†’ 8 GB root volume

Modify via console: ebs_modify_volume_console.png â†’ 12 GB

After: ebs_volume_after.png â†’ confirmed 12 GB

Verify disk:

df -h

Screenshot: disk_after_expand_dfh.png

---

âš ï¸ Special Note:

The **root volume of this EC2 instance** uses the **XFS filesystem** (not ext4).  
- To expand the filesystem: `sudo xfs_growfs -d /`  
- Do **not** use `resize2fs`, as it works only for ext4.

âŒ Error Observed

- No space left on device

ğŸ” Investigation

- df -h â†’ confirmed 100% usage
- Checked /var/log â†’ largest files

ğŸ›‘ Root Cause

- Log files + filler files exhausted root volume

âœ… Solution

- Truncated & cleaned up logs
- Expanded EBS volume (8 â†’ 12 GB)
- Verified disk space with df -h

ğŸ“Š Impact

- Restored instance functionality
- Practiced disk troubleshooting workflow
- Gained confidence in log management & EBS scaling